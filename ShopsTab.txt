if (room == rCityOfKeys)
{
    DrawFirstShopButton("Intercellular Essentials", "A Factory-owned business, operated by the sharp-toothed and jovial Julius Crossward.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFuelItem("The product of skilled orphan labour.", 20, 10, "ICanOnlySell")
        if (WeaponBayReturnNumberOfItems(1) != 4)
            DisplaySecondEngineUpgradeItem("Weapon Bay", 1, '"' + "Named for my departed wife," + '"' + " says Julius. " + '"' + "Dearest Plinky." + '"' + "##(Low damage, medium accuracy.)", 400)
        if (HasEngineComponent(1) == 0)
            DisplayThirdEngineUpgradeItem("Engine", 1, '"' + "A fast, smooth, reliable engine. The latest in Factory technology. At least, the latest that they'll let me sell." + '"' + "##(Increases speed and fuel efficiency by 20%.)", 1100)
        if (HasLegsComponent(1) == 0)
            DisplayFourthEngineUpgradeItem("Legs", 1, '"' + "The Scuttlers are your standard-model kinetopede legs. A bit weak in the joints, and they rust up a little too quickly, so keep 'em well-oiled." + '"' + "##(Increases kinetopede speed by 10%.)", 560)
        else if (HasLegsComponent(2) == 0)
            DisplayFourthEngineUpgradeItem("Legs", 2, '"' + "Fed up with your Scuttlers seizing up or shaking you around? The Mk. III Scurriers are faster and more reliable, with excellent suspension." + '"' + "##(Increases kinetopede speed by 20%.)", 1120)
        else if (HasLegsComponent(3) == 0)
            DisplayFourthEngineUpgradeItem("Legs", 3, '"' + "The Striders are the best legs on the market. Impeccable design. Silk-smooth, if you keep them well-oiled. Some truly fine legs." + '"' + " Julius is salivating a little.##(Increases kinetopede speed by 40%.)", 2240)
        else if (HasLegsComponent(5) == 0)
            DisplayFourthEngineUpgradeItem("Legs", 5, '"' + "Come." + '"' + " Julius motions you into the back room, down a flight of stairs, through a triple-locked door. He lifts a tarpaulin. " + '"' + "The Skedaddlers. New Factory tech. Technically, I'm not allowed to sell these, so keep it secret." + '"' + "##(Increases kinetopede speed by 60%.)", 4480)
        DisplayFifthItem(0, 77, '"' + "A well-timed flare can drive away the manifestations." + '"', 90, 60, "ICanBuyAndSell")
        if (oPlayer.NumberOfBoxcars < 3)
            DisplaySixthBoxcarItem('"' + "Another boxcar will increase your cargo capacity," + '"' + " says Julius. " + '"' + "Trust me, it will pay for itself." + '"', 950)
    }
    DrawSecondShopButton("Skincandle Market", "The Market burst past the borders of Skincandle Square long ago. A shambling anarchy of stalls, tents, shopfronts and thieves.", 0)
    if (SecondShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 2, '"' + "Never fall asleep again!" + '"' + " shouts a street-trader. " + '"' + "Not even if you want to!" + '"', 110, 60, "ICanBuyAndSell")
        DisplaySecondItem(0, 68, '"' + "Cures all ills!" + '"' + " claims the trader. " + '"' + "Cured my grandmother's lumbago and my daughter's flu! I could be selling this for ten times the price, but I'm a humanitarian at heart." + '"', 60, 1, "ICanOnlyBuy")
        DisplayThirdItem(0, 93, '"' + "Make a circle of salt an' you'll keep the monsters away!" + '"' + " he shouts. " + '"' + "Also you can put it on food!" + '"', 100, 70, "ICanBuyAndSell")
        DisplayFourthItem(0, 52, '"' + "Getchor genuine meat!" + '"' + " This street-trader is scabbed and toothless. He is selling unappealing lumps of animal, some with the skin still attached.", 35, 15, "ICanOnlyBuy")
    }
    DrawThirdShopButton("Gulbenkian Traders", "The Consortium is a trade conglomerate with influence throughout the Seven Cities. The huge trade-hall on Gulbenkian Street is its centre of operations here.", 0)
    if (ThirdShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 92, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 470, 240, "ICanBuyAndSell")
        DisplaySecondItem(0, 61, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 140, 100, "ICanBuyAndSell")
        DisplayThirdItem(0, 84, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 60, 25, "ICanBuyAndSell")
        DisplayFourthItem(0, 60, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 70, 35, "ICanBuyAndSell")
        DisplayFifthItem(0, 85, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 210, 100, "ICanBuyAndSell")
        DisplaySixthItem(0, 99, "An eyebrow twitches.", 2000, 1000, "ICanOnlySell")
    }
    DrawFourthShopButton("Dr. Grindylow's Exotic Goods", "Although this shop sprawls in one of the nastiest parts of Sticky End, superstition keeps thieves away.", 0)
    if (FourthShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 82, "'None of this stuff is strictly necessary, you know, but I'm a traditionalist.'", 75, 15, "ICanBuyAndSell")
        DisplaySecondItem(0, 76, '"' + "Why'd you think I set up shop in Sticky End, my friend? Plenty of gibbets to harvest." + '"', 100, 40, "ICanBuyAndSell")
        DisplayThirdItem(0, 91, '"' + "Fancy a jaunt to another city through the Mirrorwise? One of these will sort you right out, guv. Better than toiling through darkness." + '"', 250, 100, "ICanBuyAndSell")
        DisplayFourthItem(0, 15, '"' + "You're wasting my time with this knick-knack. I s'pose I could rip it apart and salvage something useful." + '"', 60, 10, "ICanOnlySell")
        DisplayFifthItem(0, 32, "Dr. Grindylow's eyes gleam strangely. 'You don't want that old thing. I'll, ah, take it off your hands.'", 400, 140, "ICanOnlySell")
        DisplaySixthItem(0, 41, "'I haven't seen the like in a long, long time. I must have it.'", 1000, 400, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawFifthShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawFifthShopButton("Nameless Library", "", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawFifthShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rClaytonsMill)
{
    DrawFirstShopButton("Fuelstop", "A ramshackle fuelling station has been set up by the door.", 1)
    if (FirstShopButtonPressed == 1)
        DisplayFuelItem("The attendant has fewer teeth than fingers.", 32, 10)
    DrawSecondShopButton("The Bar", "Alcohol at the Mill makes up in strength what it lacks in everything else.", 0)
    if (SecondShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 81, "The best kind of hooch. Well, the only kind.", 18, 8, "ICanBuyAndSell")
        if (ReputationReturnNumberOfItems(17) > 3)
            DisplaySecondItem(0, 18, "Kept in a lockbox behind the bar and reserved for only the very best customers.", 80, 60, "ICanBuyAndSell")
    }
    DrawThirdShopButton("Pretty Hess", "She sits in the corner with an untouched beer, flanked by carchar bodyguards. She buys and sells black-market items on Clayton's behalf. Her nickname is ironic.", 0)
    if (ThirdShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 35, "Pretty Hess would wink at you, if she had enough eyes.", 40, 20, "ICanBuyAndSell")
        DisplaySecondItem(0, 4, "'Genuine mycena brainstem, my love. Fresh as a daisy.'", 180, 120, "ICanBuyAndSell")
    }
    DrawFourthShopButton("Too-Clever-By-Half", "A grinning carchar in a sharp, custom-made business suit. He's an information broker, of sorts. The exact nature of his relationship with Clayton is ambiguous.", 0)
    if (FourthShopButtonPressed == 1)
    {
        DisplayFirstItem(2, 2, "The carchar sniffs. " + '"' + "Thin, ephemeral, little meat on the bones... But not wholly unappetizing." + '"', 60, 40, "ICanOnlySell")
        DisplaySecondItem(2, 4, '"' + "A seasoning at best, a spice for more substantial fare. But worthy of my consideration." + '"', 120, 90, "ICanOnlySell")
        DisplayThirdItem(2, 0, '"' + "Ahh..." + '"' + " The carchar closes his eyes, rapturous. " + '"' + "Exquisite." + '"', 400, 225, "ICanOnlySell")
        DisplayFourthItem(2, 15, '"' + "Dangerous." + '"' + " Fingers trace stains on the table. " + '"' + "Dangerous and exceedingly rare. I must know more." + '"', 1800, 1200, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawFifthShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawFifthShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawFifthShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rCityOfMasks)
{
    DrawFirstShopButton("Cholozzi Traders", "The Consortium's foothold in the city is a converted theatre on Cholozzi Boulevard.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFuelItem("Coal, oil, fossil-ghosts... All the standard means of propulsion.", 28, 12)
        DisplaySecondItem(0, 61, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 140, 70, "ICanBuyAndSell")
        DisplayThirdItem(0, 84, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 60, 25, "ICanBuyAndSell")
        DisplayFourthItem(0, 60, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 70, 35, "ICanBuyAndSell")
        DisplayFifthItem(0, 85, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 210, 100, "ICanBuyAndSell")
        DisplaySixthItem(0, 99, "An eyebrow twitches.", 2000, 1000, "ICanOnlySell")
    }
    DrawSecondShopButton("St. Liber's Plaza", "Censorship laws are relatively relaxed, and literature is a city-wide obsession. The Plaza is packed with bookstalls, coffee-shops, and street performances.", 0)
    if (SecondShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 33, "The bookstall selling these advertises them as 'romances of thrilling interest.'", 20, 5, "ICanBuyAndSell")
        DisplaySecondItem(0, 34, '"' + "Po'try!" + '"' + " shouts the book-seller. " + '"' + "Get yer po'try here! Get them while they're subversive!" + '"', 40, 15, "ICanBuyAndSell")
        DisplayThirdItem(0, 74, "The stall selling these is tucked away, but the proprietor is just a gentle-seeming intellectual. Only hardened criminals would dare sell these in any other of the Seven Cities.", 140, 80, "ICanBuyAndSell")
    }
    DrawThirdShopButton("Madam Sadie's Boutique", "Madam Sadie owns a string of brothels and gambling-dens, but the Boutique is mostly legitimate. Mostly. The clerk seems blissfully unaware of her employer's notoriety.", 0)
    if (ThirdShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 18, '"' + "Oh, that is a lot of whiskey! Is someone planning a party?" + '"' + " She giggles.", 100, 60, "ICanBuyAndSell")
        DisplaySecondItem(0, 65, '"' + "My auntie swears by this stuff. It fixes her rheumatism right up." + '"', 110, 90, "ICanBuyAndSell")
        DisplayThirdItem(0, 68, '"' + "This is one of our most popular items! It's a miracle in a bottle!" + '"', 50, 1, "ICanOnlyBuy")
    }
    DrawFourthShopButton("Carrow's Flag", "Coffee is bigger business than alcohol here, and Carrow's Flag is the biggest and busiest supplier.", 0)
    if (FourthShopButtonPressed == 1)
        DisplayFirstItem(0, 2, "The barista puts on his oven mitts and welding mask.", 114, 67, "ICanOnlyBuy")
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawFifthShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawFifthShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawFifthShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rCityOfBridges)
{
    DrawFirstShopButton("Fuel Station", "A Consortium-owned fuelstop is waiting at the kinetopede station.", 1)
    if (FirstShopButtonPressed == 1)
        DisplayFuelItem("Coal, oil, fossil-ghosts... All the standard means of propulsion.", 28, 12)
    DrawSecondShopButton("Fortune Hall", "The Consortium's headquarters, a vast complex that spans half the length of Long Bond Way. Serves as a bank, stock market, and the biggest hub of commerce in the Seven Cities.", 0)
    if (SecondShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 61, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 140, 100, "ICanBuyAndSell")
        DisplaySecondItem(0, 84, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 60, 25, "ICanBuyAndSell")
        DisplayThirdItem(0, 60, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 70, 35, "ICanBuyAndSell")
        DisplayFourthItem(0, 85, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 210, 100, "ICanBuyAndSell")
        DisplayFifthItem(0, 14, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 540, 310, "ICanBuyAndSell")
        DisplaySixthItem(0, 99, "An eyebrow twitches.", 2000, 1000, "ICanOnlySell")
    }
    DrawThirdShopButton("A Very Private Procurer", "She works for an anonymous collector with specific and peculiar tastes.", 0)
    if (ThirdShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 90, "The procurer surveys you behind dark glasses. She nods as you place this on the table.", 200, 100, "ICanOnlySell")
        DisplaySecondItem(0, 71, "When she sees this, her cherry-red lips curve into a smile.", 3640, 2080, "ICanOnlySell")
        DisplayThirdItem(0, 72, "Her lips part, revealing sharp white teeth.", 8060, 6400, "ICanOnlySell")
    }
    DrawFourthShopButton("The Grand Abattoir", "Blood and viscera spew into the void from the bowels of this huge butchery-cathedral. The Graveddonite priests will pay high prices for rare animals to slaughter.", 0)
    if (FourthShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 49, '"' + "Get the hooks, lads! The big ones!" + '"', 310, 180, "ICanOnlySell")
        DisplaySecondItem(0, 48, '"' + "We want something that will howl as it dies," + '"' + " the bishop says. " + '"' + "I can't give you half as much for a dead thing." + '"', 100, 45, "ICanOnlySell")
        DisplayThirdItem(0, 46, '"' + "This is a remarkable creature. We can cut it open and dangle it below our bridge. Let its gizzards rain on those below. Yes." + '"', 190, 105, "ICanOnlySell")
        DisplayFourthItem(0, 47, '"' + "Just a dead thing that cannot scream. It might make for an appetizer." + '"', 150, 90, "ICanOnlySell")
        DisplayFifthItem(0, 51, '"' + "I don't think I've ever seen such an animal before, in all my years." + '"' + " The bishop's voice is awed. " + '"' + "Please. I must kill it." + '"', 800, 220, "ICanOnlySell")
        DisplaySixthItem(0, 50, '"' + "Were it alive, it would be something I'd not seen before. But it is dead. And I've seen many, many dead things." + '"', 400, 205, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawFifthShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawFifthShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawFifthShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rCityOfEngines)
{
    DrawFirstShopButton("Grubworth Traders", "The City of Engines has all it could ever need, and its exports are useless. This shop is a token effort; even the Consortium has given up trying to turn a profit here.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFuelItem("The City of Engines has largely evolved beyond normal fuels.", 25, 10)
        DisplaySecondItem(0, 61, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 140, 100, "ICanBuyAndSell")
        DisplayThirdItem(0, 84, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 60, 25, "ICanBuyAndSell")
        DisplayFourthItem(0, 60, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 70, 35, "ICanBuyAndSell")
        DisplayFifthItem(0, 85, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 210, 100, "ICanBuyAndSell")
        DisplaySixthItem(0, 99, "An eyebrow twitches.", 2000, 1000, "ICanOnlySell")
    }
    DrawSecondShopButton("Bilgewish Bazaar", "A hundred thousand miraculous gadgets buzz, spin and fly amidst the chaos. Automatons and halfworking services and flying engines, touted on every corner.", 0)
    if (SecondShopButtonPressed == 1)
        DisplayFirstItem(0, 78, "A miracle of rare device. It will stop working outside the City's limits.", 300, 200, "ICanBuyAndSell")
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawThirdShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawThirdShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawThirdShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rCityOfKnives)
{
    DrawFirstShopButton("Sliverous Isle Traders", "A sharp splinter of rock jutting from the poison water. Sliverous Isle has been utterly colonized by the Consortium.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFuelItem("Coal, oil, fossil-ghosts... All the standard means of propulsion", 25, 10)
        DisplaySecondItem(0, 61, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 140, 100, "ICanBuyAndSell")
        DisplayThirdItem(0, 84, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 60, 25, "ICanBuyAndSell")
        DisplayFourthItem(0, 60, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 70, 35, "ICanBuyAndSell")
        DisplayFifthItem(0, 85, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 210, 100, "ICanBuyAndSell")
        DisplaySixthItem(0, 99, "An eyebrow twitches.", 2000, 1000, "ICanOnlySell")
    }
    DrawSecondShopButton("The Alchemist's Spine", "The alchemists are willing to part with some of their less innovative concoctions.", 0)
    if (SecondShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 66, "Useful for curing insomniacs before it's too late.", 70, 35, "ICanBuyAndSell")
        DisplaySecondItem(0, 79, "The staples of any good alchemist's laboratory.", 65, 32, "ICanBuyAndSell")
        DisplayThirdItem(0, 73, "The alchemist turns this over and over in her hands with great care. She is not a businesswoman by trade, and hides her eagerness poorly.", 540, 270, "ICanOnlySell")
        DisplayFourthItem(0, 102, "Unfortunately, medicine is the least of the alchemists' priorities.", 68, 34, "ICanOnlySell")
        DisplayFifthItem(0, 96, "Ghost-essence is a crucial ingredient in dozens of potions.", 82, 40, "ICanOnlySell")
        DisplaySixthItem(0, 69, "An untested ingredient. A minor gamble on the alchemists' part.", 85, 100, "ICanOnlySell")
    }
    DrawThirdShopButton("Slabber's Weaponry", "Horace Slabber left his bankrupt weapons empire to his daughter Amity. She built it back to its former glory, and aims to compete with the Factory itself.", 0)
    if (ThirdShopButtonPressed == 1)
    {
        if (WeaponBayReturnNumberOfItems(5) != 4)
            DisplayEngineUpgradeItem("Weapon Bay", 5, '"' + "Don't let Crossward fool you," + '"' + " says Amity. " + '"' + "If you want something reliably exploded, this is the only way to go." + '"' + "##(Medium damage, high accuracy.)", 800)
        DisplaySecondItem(0, 92, '"' + "I hate the occult and everything that comes with it. Give me a good honest bullet to the brain any day. Warding iron is about the only defence an honest girl like me can hope for." + '"', 460, 230, "ICanBuyAndSell")
        DisplayThirdItem(0, 14, '"' + "Guns? Yeah, we got guns." + '"', 280, 140, "ICanBuyAndSell")
    }
    DrawFourthShopButton("The Corpse and Hatchet", "Not just a grotty tavern in Slaughterers' Wharf; THE grotty tavern in Slaughterers' Wharf.", 0)
    if (FourthShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 81, "The fumes alone make you giddy.", 15, 5, "ICanBuyAndSell")
        DisplaySecondItem(0, 103, "A drink in high demand, and short supply.", 140, 80, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawFifthShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawFifthShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawFifthShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rCityOfAngels)
{
    DrawFirstShopButton("Pharangael Traders", "Imported goods are torn open in search of trace elements of blasphemy.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFuelItem("Coal, oil, fossil-ghosts... All the standard means of propulsion", 25, 10)
        DisplaySecondItem(0, 61, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 140, 100, "ICanBuyAndSell")
        DisplayThirdItem(0, 84, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 60, 25, "ICanBuyAndSell")
        DisplayFourthItem(0, 60, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 70, 35, "ICanBuyAndSell")
        DisplayFifthItem(0, 85, "The merchant hides his eyes behind dark glasses. His smile does not flicker.", 210, 100, "ICanBuyAndSell")
        DisplaySixthItem(0, 99, "An eyebrow twitches.", 2000, 1000, "ICanOnlySell")
    }
    DrawSecondShopButton("Angel Vineyards", "The angels glide among the vines and bless the fruit.", 0)
    if (SecondShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 3, "The purest of wines. The angels drink nothing else.", 135, 75, "ICanOnlyBuy")
        DisplaySecondItem(0, 80, "A rarity indeed. So rare in fact that the vineyard itself buys it back for a good price.", 1000, 550, "ICanOnlySell")
    }
    DrawThirdShopButton("Drabtooth Market", "Drabtooth is the largest funghetto in all the Cities, and boasts a sprawling market to almost rival Skincandle.", 0)
    if (ThirdShopButtonPressed == 1)
    {
        if (WeaponBayReturnNumberOfItems(2) != 4)
            DisplayEngineUpgradeItem("Weapon Bay", 2, "This questionably legal weapon shoots missiles infected with mind-altering spores, and will ravage any enemy's Sanity.##(Medium damage, low accuracy, sanity effects.)", 1880)
        DisplaySecondItem(0, 102, "Most of the market's goods are botanical and benign.", 68, 34, "ICanBuyAndSell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawFourthShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (FourthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawFourthShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (FourthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawFourthShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (FourthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rFargyleKeep)
{
    DrawFirstShopButton("Depthless Delights", "The Poet-Knights would love to abstain from the grubby world of commerce, but they have too many bad habits to support. Depthless Delights maintains its credibility by treating customers with disdain.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 18, '"' + "I suppose this is what we are known for," + '"' + " yawns the squire behind the counter. " + '"' + "Apart from our beauty, nobility, courage and unmatched poetic skill." + '"', 90, 55, "ICanBuyAndSell")
        DisplaySecondItem(0, 65, "The squire appears to be composing a poem in his head. He occasionally mutters rhyming couplets, and waves you away when you try to speak to him.", 50, 30, "ICanBuyAndSell")
        DisplayThirdItem(0, 34, "The squire is too busy cleaning his fingernails to answer your questions about this item.", 50, 15, "ICanBuyAndSell")
        DisplayFourthItem(0, 66, "You have captured the squire's attention. " + '"' + "We're always looking out for these," + '"' + " he says. " + '"' + "It helps with the night terrors." + '"', 70, 80, "ICanOnlySell")
        DisplayFifthItem(0, 2, '"' + "We simply cannot buy this fast enough. It always sells out in an instant." + '"', 110, 80, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rGhoulwatch)
{
    if (global.ConcernsConcludedFlag[49] != 12)
    {
        DrawFirstShopButton("Ghoulwatch Ironworks", "The air shimmers with heat. Ghouls stir great vats of toxic chemicals; they have no need for gloves or masks.", 0)
        if (FirstShopButtonPressed == 1)
        {
            DisplayFuelItem("Ghoulwatch runs on coal, not fossil-ghosts. They seem to have a moral squeamishness regarding the use of departed souls as fuel.", 25, 10)
            if (HasArmourComponent(2) == 0)
                DisplaySecondEngineUpgradeItem("Armour", 2, "Warding iron is a useful buffer against the ravages of madness, darkness, and the occult.##(Increases Hull strength by 40, reduces sanity loss, and resists occult weaponry.)", 1460)
            DisplayThirdItem(0, 92, "A Ghoulwatch speciality, the means of manufacture a well-kept secret.", 380, 160, "ICanBuyAndSell")
            DisplayFourthItem(0, 84, "The bleak walls of Ghoulwatch bristles with artillery, and it stockpiles gunpowder like a dragon hoards gold.", 40, 25, "ICanBuyAndSell")
        }
        DrawSecondShopButton("Gibbeter's Corner", "In Ghoulwatch, dead humans who fail to become ghouls are hanged as traitors. The gibbet-harvesters consequently enjoy a roaring trade.", 0)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 76, "Of course, it has to be the finger of a murderer - not any old finger. Hence the price.", 80, 40, "ICanBuyAndSell")
            DisplaySecondItem(0, 75, "The gibbeters have entire grisly necklaces of hands. Some have hands on sticks, which they take great pleasure in waving in your face.", 200, 100, "ICanBuyAndSell")
            DisplayThirdItem(0, 83, "A murderer's hand will sell for plenty, but the innocent are worth more whole.", 250, 110, "ICanBuyAndSell")
        }
        DrawThirdShopButton("Bleakley Shipyard", "When the House steals a ship from some bitter otherworld sea, it almost always appears near Ghoulwatch. The famed flying ships are born of practicality, not whimsy.", 0)
        if (ThirdShopButtonPressed == 1)
        {
            if (WeaponBayReturnNumberOfItems(4) != 4)
                DisplayEngineUpgradeItem("Weapon Bay", 4, "A gruesomely over-large cannon.##(High damage, low accuracy.)", 1240)
            if (WeaponBayReturnNumberOfItems(7) != 4)
                DisplaySecondEngineUpgradeItem("Weapon Bay", 7, "The ghost is tortured before firing, to ensure it shrieks with sufficient gusto.##(No damage. Severe sanity effects. Perfect accuracy.)", 2000)
            DisplaySecondItem(0, 60, "Hundreds of ships turn up here, many with hulls still damp. The ships are torn apart for scraps, and their bewildered crew welcomed as citizens.", 60, 30, "ICanBuyAndSell")
        }
        DrawFourthShopButton("Treats & Torments", "No ghoul can resist a memory of what it was like to live: tastes, smells, loves, blood in the veins.", 0)
        if (FourthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 5, "Echoes of laughter.", 230, 110, "ICanOnlySell")
            DisplaySecondItem(0, 6, "The haunting of tears.", 230, 110, "ICanOnlySell")
            DisplayThirdItem(0, 7, "The most alive that the living can feel.", 230, 110, "ICanOnlySell")
            DisplayFourthItem(0, 10, "A heart that beat like a drum.", 230, 110, "ICanOnlySell")
            DisplayFifthItem(0, 11, "Fire in the darkness.", 230, 110, "ICanOnlySell")
        }
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawFifthShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawFifthShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawFifthShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (FifthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rMausalonRiver)
{
    DrawFirstShopButton("Little Village Shops", "Every village along the River has a little picturesque shop, usually staffed by elderly ladies.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFuelItem("The elderly ladies are surprisingly astute when it comes to the market price of fuel.", 30, 8)
        DisplaySecondItem(0, 98, '"' + "Please take it off our hands, dearie, we can't get rid of the bloody stuff." + '"', 70, 32, "ICanOnlyBuy")
        DisplayThirdItem(0, 95, '"' + "We find lumps of it in the grave-rubble now and then. It's a bit of a shock to the system!" + '"', 460, 230, "ICanBuyAndSell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rHarlequin)
{
    DrawFirstShopButton("The Grotesquerie", "Clowns in white coats perform their craft upon willing and unwilling subjects, with vats and pins and scalpels.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 7, "The Humourists of the Grotesquerie often take their patients' memories, particularly the memories of their treatments. They review them at leisure, and sell them when bored.", 90, 70, "ICanBuyAndSell")
        DisplaySecondItem(0, 54, '"' + "At the bottom of a mutagen vat it was, shrieking," + '"' + " one of the Humourists tells you. " + '"' + "Your guess is as good as ours, ha haha ha." + '"', 430, 215, "ICanBuyAndSell")
        DisplayThirdItem(0, 69, '"' + "Distilled brain-fluid from discarded patchworks. A slimy by-product of our surgical endeavours, ha ha." + '"', 500, 250, "ICanOnlyBuy")
        DisplayFourthItem(0, 40, '"' + "It must be a relic of older times, ha haha ha! We must study it, give it to us. Can you imagine, can you imagine, can you even imagine?" + '"', 500, 250, "ICanOnlySell")
        DisplayFifthItem(0, 94, '"' + "Oh, godmatter - this is godmatter. Imagine a god-thing we made, and imagine it in torment. Oh, give it to us." + '"', 1700, 870, "ICanOnlySell")
        DisplaySixthItem(4, 28, "This jar of coagulant blood is somehow different from other items on sale. The Humourists refuse to explain its purpose, and only whisper in veneration. There's an eerie presence inside the jar. It sees you.", 1000, 100, "ICanOnlyBuy")
    }
    DrawSecondShopButton("Grueber's Sardonic Implements", "Grueber is not merely a merchant - he also offers his services as a prankster, musician and thief for hire. His shop is fashioned in the sickeningly colourful Harlequin style and filled with weaponry.", 0)
    if (SecondShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 76, '"' + "Plenty of killers around here," + '"' + " says Grueber, taking a drag on his cheap little cigarette. " + '"' + "Plenty of corpses, too." + '"', 30, 20, "ICanOnlyBuy")
        DisplaySecondItem(0, 65, '"' + "Calms the mind, stiffens the nerves. Good if you want to survive here." + '"', 100, 55, "ICanOnlyBuy")
        DisplayThirdItem(0, 83, '"' + "I got a job lot of these a while ago. Stack 'em high, sell 'em cheap, that's the way to do it." + '"', 70, 20, "ICanOnlyBuy")
        DisplayFourthItem(0, 14, '"' + "Everyone's out to get you. Get them first." + '"', 260, 100, "ICanOnlyBuy")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawThirdShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawThirdShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawThirdShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rPannachak)
{
    DrawFirstShopButton("Svadilfari's Blessing", "A shop that sells salvage reclaimed from Svadilfari's depths. Their fuel is, perhaps unsurprisingly, very cheap indeed.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFuelItem("Svadilfari's water, they call it. Or Svadilfari's piss, for a joke.", 15, 6)
        DisplaySecondItem(0, 42, "They found this deep in the recesses of Svadilfari, and they're sure it must be valuable.", 430, 215, "ICanOnlyBuy")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rMycenaFreeState)
{
    if (global.ConcernsConcludedFlag[34] == 2 && oInventories.MycenaFreeStateIsActuallyFree == 0)
    {
        DrawFirstShopButton("State-Approved Goods", "Clowns shamelessly give this shop a shake-down even as you're waiting to buy something. The mycena behind the till hands over a bribe without rancour, only fear.", 0)
        if (FirstShopButtonPressed == 1)
        {
            DisplayFuelItem("The queue is STILL longer than the street.", 50, 10)
            DisplaySecondItem(0, 85, "They always need more stone for the statue of the Queen, explains the shop-keeper. Any stone will do.", 210, 230, "ICanOnlySell")
            DisplayThirdItem(0, 98, "More stone for the statue.", 70, 90, "ICanOnlySell")
            DisplayFourthItem(0, 60, "The statue needs plenty of scaffolding.", 70, 80, "ICanOnlySell")
            DisplayFifthItem(0, 86, '"' + "Bloodstained stone seems oddly appropriate," + '"' + " says the shop-keeper quietly.", 360, 195, "ICanOnlySell")
        }
    }
    else if (global.ConcernsConcludedFlag[34] != 2 && oInventories.MycenaFreeStateIsActuallyFree == 0)
    {
        DrawFirstShopButton("State-Approved Goods", "Patchwork soldiers shamelessly give this shop a shake-down even as you're waiting to buy something. The mycena behind the till hands over a bribe without rancour, only fear.", 0)
        if (FirstShopButtonPressed == 1)
        {
            DisplayFuelItem("The queue is longer than the street.", 70, 10)
            DisplaySecondItem(0, 85, "They always need more stone for the statue of the Emperor, explains the shop-keeper. Any stone will do.", 210, 115, "ICanOnlySell")
            DisplayThirdItem(0, 98, "More stone for the statue.", 70, 40, "ICanOnlySell")
            DisplayFourthItem(0, 60, "The statue needs plenty of scaffolding.", 70, 45, "ICanOnlySell")
            DisplayFifthItem(0, 86, '"' + "Bloodstained stone seems oddly appropriate," + '"' + " says the shop-keeper quietly.", 360, 195, "ICanOnlySell")
        }
    }
    else if (oInventories.MycenaFreeStateIsActuallyFree == 1)
    {
        DrawFirstShopButton("Makeshift Store", "The mycena behind the till looks happy and at ease.", 0)
        if (FirstShopButtonPressed == 1)
        {
            DisplayFuelItem("No more long queues for fuel.", 50, 10)
            DisplayFirstItem(0, 60, "The stone is in abundance, but wood is still needed.", 70, 80, "ICanOnlySell")
        }
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rBuzzardsOmen)
{
    if (oInventories.GuttergutsWon == 0)
    {
        DrawFirstShopButton("Septuagint & Sons", "The Septuagints sell grubby things in a grubby town. That's why they're so wealthy.", 0)
        if (FirstShopButtonPressed == 1)
        {
            DisplayFuelItem("Sonny and Junior Septuagint are running the shop today, and they make several sneering comments of the sort that can be easily ignored.", 45, 10)
            DisplaySecondItem(0, 27, '"' + "Ever felt like a god?" + '"' + " asks Junior, raising his monobrow so high it nearly escapes his head.", 90, 45, "ICanBuyAndSell")
            DisplayThirdItem(0, 81, '"' + "Finest quality," + '"' + " assures Sonny.", 20, 8, "ICanBuyAndSell")
            DisplayFourthItem(0, 29, '"' + "Don't believe the stories," + '"' + " says Junior. " + '"' + "S'good stuff." + '"', 24, 12, "ICanBuyAndSell")
            DisplayFifthItem(0, 35, "Sonny barrages you with crass innuendo.", 36, 18, "ICanBuyAndSell")
            DisplaySixthItem(0, 11, "Junior barrages you with more crass innuendo.", 230, 140, "ICanOnlySell")
        }
    }
    else
    {
        DrawFirstShopButton("Guttergut Enterprises", "The Gutterguts have taken over all the Septuagints' old businesses.", 0)
        if (FirstShopButtonPressed == 1)
        {
            DisplayFuelItem("Clem Guttergut is running the shop today. She's happy to give you a discount.", 50, 10)
            DisplaySecondItem(0, 27, '"' + "Ever felt like a god?" + '"' + " asks Clem with a smile.", 90, 45, "ICanBuyAndSell")
            DisplayThirdItem(0, 81, '"' + "Finest quality," + '"' + " assures Clem.", 20, 8, "ICanBuyAndSell")
            DisplayFourthItem(0, 29, '"' + "Don't believe the stories," + '"' + " says Clem.", 24, 12, "ICanBuyAndSell")
            DisplayFifthItem(0, 35, "Clem winks at you.", 36, 18, "ICanBuyAndSell")
            DisplaySixthItem(0, 11, "Clem subjects you to more winking and nudging.", 230, 140, "ICanOnlySell")
        }
    }
    DrawSecondShopButton("Didn't See 'THESE' Bargains Coming", "Supplies for the modern diviner. The neon sign sizzles and smells faintly of smoke.", 0)
    if (SecondShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 82, "It's a half-hearted selection. The shrunken heads are clearly made of rubber, and the candles are a garish red.", 70, 40, "ICanBuyAndSell")
        DisplaySecondItem(0, 30, "You've heard stories of diviners seeing the future in drug-induced hallucinations, but it strikes you as even less reliable than the rest of the profession.", 50, 25, "ICanBuyAndSell")
        DisplayThirdItem(0, 39, "They rattle and dance of their own accord. " + '"' + "A six means good luck," + '"' + " assures the shop-keeper. Of course.", 76, 36, "ICanBuyAndSell")
        DisplayFourthItem(0, 93, "Good for disrupting the occult, salt, although you're not sure how it relates to divination.", 80, 38, "ICanBuyAndSell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawThirdShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawThirdShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawThirdShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rGossamerSmile)
{
    DrawFirstShopButton("Silkworks", "The finest of silks from the finest of spiders.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 61, "In demand throughout the House, Aranach silk is of matchless quality.", 80, 65, "ICanOnlyBuy")
        DisplaySecondItem(0, 67, "From the other end of the spider.", 45, 22, "ICanOnlyBuy")
        if (WeaponBayReturnNumberOfItems(9) != 4)
            DisplayThirdEngineUpgradeItem("Weapon Bay", 9, "An unholy amalgamation of gun-parts and spider-parts.##(Low damage, high accuracy, chance to immobilize enemy.)", 2900)
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplaySecondItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rCarapas)
{
    DrawFirstShopButton("Oldbone Forge", "A thrall greets you at the door with a smile. The Oldbone Forge is where the blacksmiths of Carapas ply their trade.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFuelItem("The forges must always be fed.", 40, 10)
        if (HasArmourComponent(3) == 0)
            DisplaySecondEngineUpgradeItem("Armour", 3, "The shell of an omega beetle is near-impervious to harm. Ironically, this means they have been hunted to extinction.##(Increases Hull strength by 150.)", 6500)
        DisplayThirdItem(0, 14, "The smiths of Carapas lack the capacity to make guns, but their swords are of the finest quality.", 280, 150, "ICanBuyAndSell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rBluesteelCourt)
{
    DrawFirstShopButton("The Noble Steed", "An inn built on a shelf above the Court. There is a blue dragonfly emblazoned on its sign.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 81, "A despicable beverage, like rubbing alcohol but without the charm. This is all that most peasants can hope for.", 25, 8, "ICanBuyAndSell")
        DisplaySecondItem(0, 103, "The finest drink on offer, and one only the aristocracy can afford.", 140, 70, "ICanBuyAndSell")
        DisplayThirdItem(0, 3, "Much prized and seldom seen. The innkeeper is desperate to renew his stock.", 200, 150, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rScornvaunt)
{
    if (global.ConcernsConcludedFlag[48] != 4 && global.ConcernsConcludedFlag[48] != 5)
    {
        DrawFirstShopButton("The Hive", "Hive-thralls are not just free labour. They also provide useful incubation for wasp-eggs.", 0)
        if (FirstShopButtonPressed == 1)
        {
            DisplayFuelItem("Scornvaunt has discovered great deposits of oil and tar in the swamp, and its primitive industry makes only sporadic use of it.", 25, 10)
            DisplaySecondItem(0, 62, "The blood of the Hive.", 90, 50, "ICanOnlyBuy")
            DisplayThirdItem(0, 57, "A wasp-egg is an object of near-reverence in Scornvaunt, but like everything, it has its price.", 200, 120, "ICanOnlyBuy")
        }
    }
    else
    {
        DrawFirstShopButton("The Hive", "With the Hive-thralls freed, prices have almost doubled.", 0)
        if (FirstShopButtonPressed == 1)
        {
            DisplayFuelItem("Scornvaunt has discovered great deposits of oil and tar in the swamp, and its primitive industry makes only sporadic use of it.", 50, 15)
            DisplaySecondItem(0, 62, "The blood of the Hive.", 180, 50, "ICanOnlyBuy")
            DisplayThirdItem(0, 57, "A wasp-egg is an object of near-reverence in Scornvaunt, but like everything, it has its price.", 400, 220, "ICanOnlyBuy")
        }
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rGrossfathom)
{
    DrawFirstShopButton("Muddy Shack", "The shop doesn't have a name, and there's a baby screaming in the corner. The owner's warts have warts.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 79, "Shelves and shelves of dusty jars, the labels long faded.", 120, 90, "ICanBuyAndSell")
        DisplaySecondItem(0, 82, "Animal eyeballs bunched like grapes, dolls stuck with pins, shrunken heads and taxidermied birds. A reasonable selection, if perhaps unambitious.", 60, 30, "ICanBuyAndSell")
        DisplayThirdItem(0, 43, "The shop-keeper's eyes light up, and she gabbles something about a prophecy and a return.", 300, 140, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 175, 130, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rPenitentsBluff)
{
    DrawFirstShopButton("The Arena", "Always on the lookout for monsters to starve and slaughter.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 49, "The Ringmaster's eyes light with childish glee. " + '"' + "Ahh, what a spectacle this will make!" + '"', 360, 215, "ICanOnlySell")
        DisplaySecondItem(0, 14, "The gladiators are always in need of new weapons, and rifles are viewed with a mixture of suspicion and awe.", 300, 280, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rGlitterberg)
{
    DrawFirstShopButton("Church of the Loving Gods", "Folk of the Entomarch worship only gods who offer love in return. The list has become vanishingly small since the Empire of Thread began its predations. These congregants are struck by plague and desperate for divine mercy.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 68, "They are willing to try anything. Anything at all.", 1, 75, "ICanOnlySell")
        DisplaySecondItem(0, 102, "You know the herbs cannot cure the plague, but they can ease the symptoms.", 64, 50, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rScarsOfSheng)
{
    DrawFirstShopButton("Haytham's", "Peptimar Haytham claims to run a legitimate business, but everyone knows his goods are smuggled to him by quartermasters at the barracks.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFuelItem("Siphoned directly from some military vehicle, no doubt.", 40, 10)
        if (WeaponBayReturnNumberOfItems(10) != 1)
            DisplaySecondEngineUpgradeItem("Weapon Bay", 10, "A favourite of the Principate military. Why fight when you can send a combat-golem to do it for you?##(High damage, high accuracy, creates a Golem combatant to fight for you. One use only per battle.)", 2310)
        DisplayThirdItem(0, 14, "Peptimar's operation is so successful that his arsenal is even larger than the one in the barracks.", 300, 150, "ICanBuyAndSell")
        DisplayFourthItem(0, 84, '"' + "Because how else are you going to fire all those guns?" + '"' + " asks Peptimar, shooting you a gap-toothed grin.", 80, 35, "ICanBuyAndSell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rEldAbrathat)
{
    DrawFirstShopButton("The Screws", "A web of alleys infamously bursting with occult stalls and shops. Some only appear on certain days. Some are built of glass and rubber or filled with darkness or stretched across strange dimensions. At least one is built inside the groaning mouth of a live whale.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 82, "The shop is crooked, on the verge of collapse. The windows are broken and mould mottles its walls. All for show, you're sure.", 65, 20, "ICanBuyAndSell")
        DisplaySecondItem(0, 16, "A shop filled with mannequins, statues, and dolls. They turn to face you as you open the door.", 180, 90, "ICanBuyAndSell")
        DisplayThirdItem(0, 87, "Your body bends in discomfiting ways to get through the door. The proprietor is a proud worshipper of Anglecrab, and hangs from the ceiling with his elbows twisted through his eye-sockets.", 420, 150, "ICanBuyAndSell")
        DisplayFourthItem(0, 41, "A dozen shop-keepers compete to be the one to take this off your hands.", 1000, 500, "ICanOnlySell")
        DisplayFifthItem(0, 32, "There are grimoires on sale up and down the street, but none so old, and none so coveted.", 400, 180, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rPhobetorQuinn)
{
    DrawFirstShopButton("The Foreigners' Palace", "Waves of incense roll over you like waves. Artificial moths flutter amid the high rafters, and many-coloured strings of lights drape the walls like vines. Here, thoughts and memories are traded like bottles of wine.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 90, "A beautifully-engraved little box of varnished mahogany. Memories live longer in mahogany, it is said.", 120, 85, "ICanOnlyBuy")
        DisplaySecondItem(0, 5, "The owner of the Palace is half a dream herself, and she moves without moving. " + '"' + "A joy so brittle it will make you weep," + '"' + " she promises.", 240, 90, "ICanOnlySell")
        DisplayThirdItem(0, 6, '"' + "A pain that drills its roots to your soul, and grows as you diminish." + '"', 240, 120, "ICanOnlySell")
        DisplayFourthItem(0, 10, '"' + "A thrill that reminds you to live." + '"', 240, 130, "ICanOnlySell")
        DisplayFifthItem(0, 8, '"' + "A place you may never see," + '"' + " suggests the dream-woman, then pauses as she assesses you. " + '"' + "Though perhaps you, of all people, will." + '"', 240, 120, "ICanOnlySell")
        DisplaySixthItem(0, 11, '"' + "A private love, recklessly unhidden." + '"', 240, 110, "ICanOnlySell")
    }
    if (global.ConcernsConcludedFlag[52] != 1)
    {
        DrawSecondShopButton("Dreamer's Den", "Owned by the Ten-a-Penny Man and managed by a faceless creature named Zeke. Dreamer's Den is red-lit, red-leathered, and unsanitary.", 0)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 1, "Zeke gurgles enthusiastically. The Porcelain Spire looms just outside, and this product is responsible for the Den's booming trade.", 200, 110, "ICanBuyAndSell")
            DisplaySecondItem(0, 2, "A pick-me-up for those lost too deeply in salve-induced sleep.", 130, 50, "ICanBuyAndSell")
            DisplayThirdItem(0, 27, "Drugs are legal in Phobetor Quinn, even godsmoke. A customer nearby has sampled some, and threatens to smite you if you don't follow suit.", 110, 85, "ICanBuyAndSell")
            DisplayFourthItem(0, 30, "Mere hallucinations seem bland when you could be manifesting your dreams. Toadskin is sold as a supplement to harder drugs.", 90, 70, "ICanBuyAndSell")
            DisplayFifthItem(0, 28, "A customer on colour-dust barges past you, fixated on the ceiling.", 110, 55, "ICanBuyAndSell")
        }
    }
    else
    {
        DrawSecondShopButton("Dreamer's Den", "Owned by the Ten-a-Penny Man, Dreamer's Den is red-lit, red-leathered, and unsanitary.", 0)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 1, "The Porcelain Spire looms just outside, and this product is responsible for the Den's booming trade.", 200, 110, "ICanBuyAndSell")
            DisplaySecondItem(0, 2, "A pick-me-up for those lost too deeply in salve-induced sleep.", 110, 60, "ICanBuyAndSell")
            DisplayThirdItem(0, 27, "Drugs are legal in Phobetor Quinn, even godsmoke. A customer nearby has sampled some, and threatens to smite you if you don't follow suit.", 90, 45, "ICanBuyAndSell")
            DisplayFourthItem(0, 30, "Mere hallucinations seem bland when you could be manifesting your dreams. Toadskin is sold as a supplement to harder drugs.", 50, 25, "ICanBuyAndSell")
            DisplayFifthItem(0, 28, "A customer on colour-dust barges past you, fixated on the ceiling.", 110, 55, "ICanBuyAndSell")
        }
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawThirdShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawThirdShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawThirdShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1300, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rGandola)
{
    DrawFirstShopButton("Fishermens' Wharf", "A dozen platforms on stilts, connected by ropes and ladders and sloping bridges. Fish-juices soak the wooden boards, making them stinking and slick.", 0)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 59, "Trout is touted at every corner. Some are as long as a man.", 30, 15, "ICanOnlyBuy")
        DisplaySecondItem(0, 81, "Gandola is full of drunk, happy fishermen.", 15, 5, "ICanBuyAndSell")
        DisplayThirdItem(0, 103, "Gandolans have a legendary appreciation for this beverage, and are constantly lamenting its short supply.", 140, 100, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rFoundersFire)
{
    DrawFirstShopButton("Shipshade Market", "A riotously colourful market, built in the shadow of the Founder. Amongst the crowds are species and creeds and styles of clothing that you never saw back in the Cities.", 1)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFuelItem("The Founder is never satiated.", 40, 15)
        if (HasArmourComponent(1) == 0)
            DisplaySecondEngineUpgradeItem("Armour", 1, "The blacksmiths here are only rivalled in Ghoulwatch and the Factory.##(Increases Hull strength by 60.)", 1800)
        DisplayThirdItem(0, 84, "Merchants sit on barrels of explosive death, laughing and calling to passers-by. Risky enough in itself, and you hurry away when one sparks up a cigarillo.", 70, 40, "ICanBuyAndSell")
        DisplayFourthItem(0, 104, "The recipe is secret, but it certainly requires otherworldly ingredients. The spicers enjoy a very close relationship with the summoners.", 380, 200, "ICanBuyAndSell")
        DisplayFifthItem(0, 61, "Silk from the Entomarch, highly prized and in short supply.", 140, 100, "ICanOnlySell")
    }
    DrawSecondShopButton("Summoners' Circle", "The Prince's Heart and his shadowy group of summoners will pay well for any information about other worlds.", 0)
    if (SecondShopButtonPressed == 1)
        DisplayFirstItem(1, 19, "You meet the summoner in a luxurious suite, and she listens to your findings attentively, making reams of notes.", 300, 180, "ICanOnlySell")
    DrawThirdShopButton("The Prince's Menagerie", "The Prince is always on the lookout for new additions to his zoological gardens. One of his Hands is willing to meet with you.", 0)
    if (ThirdShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 49, "The chained beast lunges, and the Hand does not move an inch. Slavering teeth snap inches from his face. " + '"' + "Interesting." + '"', 320, 200, "ICanOnlySell")
        DisplaySecondItem(0, 51, '"' + "Ah, the Prince has several of these creatures already. I suppose one more cannot hurt." + '"', 150, 100, "ICanOnlySell")
        DisplayThirdItem(0, 46, '"' + "I had thought the Menagerie boasted animals from every other world. Evidently I was wrong." + '"', 700, 200, "ICanOnlySell")
        DisplayFourthItem(0, 57, '"' + "Perhaps these may hatch into something worth caging." + '"', 200, 100, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawFourthShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (FourthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawFourthShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (FourthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawFourthShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (FourthShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rHextall)
{
    DrawFirstShopButton("Gra Bin Sha's Academic Supplies", "You cannot imagine a mycena owning such a prestigious shop back in the Cities.", 1)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 36, '"' + "Fascinating stuff, this," + '"' + " says Gra Bin Sha. It yawns exaggeratedly, then winks." + '"', 50, 25, "ICanBuyAndSell")
        DisplaySecondItem(0, 38, '"' + "Hate reality? Too much time on your hands? Don't mind going mad, as long as it's with power? The study of the occult might just be for you, my friend." + '"', 230, 120, "ICanBuyAndSell")
        DisplayThirdItem(0, 34, '"' + "Oh, you're a poet too? Fascinating. I'd ask to hear your latest effort but oops, too late, I already killed myself." + '"', 60, 38, "ICanBuyAndSell")
    }
    DrawSecondShopButton("Monkton's Slurry", "Caters to scholars of unusual appetite.", 0)
    if (SecondShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 52, '"' + "Thish will go good in the shlurry," + '"' + " says Monkton.", 40, 20, "ICanOnlySell")
        DisplaySecondItem(0, 89, '"' + "Oh, yesh, a nishe rare dish. I usually have to go find it myshelf." + '"', 90, 60, "ICanOnlySell")
        DisplayThirdItem(0, 55, '"' + "Shome of them likesh to eat bugsh. I don't like that, though." + '"', 80, 50, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawThirdShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawThirdShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawThirdShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rTheOldHallow)
{
    DrawFirstShopButton("The Bar", "The Proprietress drums her fingers on the bar, waiting for your order.", 1)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFuelItem("The Proprietress has a hoard of coal in her cellar.", 35, 10)
        DisplaySecondItem(0, 97, '"' + "The flavours have always been famous. Care to try a half-pint of regret? It tastes a little like grapefruit, curdled milk and tequila." + '"', 48, 24, "ICanBuyAndSell")
        DisplayThirdItem(0, 3, '"' + "Go on, have a glass. One for the road and one to make sure the first gets home." + '"', 100, 85, "ICanBuyAndSell")
        DisplayFourthItem(0, 18, '"' + "Dealing with those pretentious boobs is a nightmare - err, pun not intended. But their whiskey makes it worthwhile." + '"', 110, 38, "ICanBuyAndSell")
        DisplayFifthItem(2, 2, "The Proprietress lowers her voice. " + '"' + "Listen, I put on an act of mysterious omniscience for the punters, but really I just have a few trusted people who keep me in the loop. Care to get involved?" + '"', 60, 35, "ICanOnlySell")
        DisplaySixthItem(2, 0, "The Proprietress has no visible reaction, but she slides you more money than usual.", 400, 220, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rTheKelpFortress)
{
    DrawFirstShopButton("A Hammerhead Representative", "There are some select items which the Hammerheads are keen to purchase from travellers like yourself.", 1)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 89, "Sharks are big meat-eaters.", 90, 80, "ICanOnlySell")
        DisplaySecondItem(0, 59, "Fish is also high on their menu.", 70, 50, "ICanOnlySell")
        DisplayThirdItem(2, 19, "For a modest price, they can heal your scarred mind.", 180, 90, "ICanOnlySell")
        DisplayFourthItem(0, 40, "They like to collect the relics of bygone age.", 500, 220, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rRecalcitrance)
{
    if (global.UnlockedDoorFlag[6] == 0)
    {
        DrawFirstShopButton("Middling Enterprises", "A decaying shop guarded by what you believe are best described as 'hired goons.' The moustachioed Harold Middling has an exhausted look about him, and he explains that he has been fending off looters for weeks.", 1)
        if (FirstShopButtonPressed == 1)
        {
            DisplayFuelItem("It's in scarce supply, these days.", 100, 30)
            DisplaySecondItem(0, 74, "Few believe in the grace of the Sanctioned Gods here. Most turn towards the other, long forgotten deities.", 60, 32, "ICanBuyAndSell")
            DisplayThirdItem(0, 60, "People are in a dire need of planks to board up their windows.", 70, 60, "ICanOnlySell")
            DisplayFourthItem(0, 29, "Sweat drips from Harold's brow. " + '"' + "I, err, yes, the demand for this item has grown lately, I may, err, I may have some interested buyers." + '"', 60, 55, "ICanOnlySell")
        }
        DrawSecondShopButton("Mayor Wrackhaven", "The Mayor will buy anything that she thinks may help against the moths.", 0)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 14, '"' + "Standard weaponry so far has not made... much of an impact. But it's better than nothing." + '"', 300, 200, "ICanOnlySell")
            DisplaySecondItem(0, 70, "The Mayor's eyes burn strangely. " + '"' + "Exactly what we are looking for." + '"', 1200, 600, "ICanOnlySell")
            DisplayThirdItem(0, 84, '"' + "We always need more." + '"', 120, 62, "ICanOnlySell")
        }
        if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
        {
            DrawThirdShopButton("Strange Little Shop", "It has been here a long time.", 1)
            if (ThirdShopButtonPressed == 1)
            {
                DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
                DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
                DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
                DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
            }
        }
        else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
        {
            DrawThirdShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
            if (ThirdShopButtonPressed == 1)
            {
                DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
                DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
                DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
                DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
            }
        }
        else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
        {
            DrawThirdShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
            if (ThirdShopButtonPressed == 1)
            {
                DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
                DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
                DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
                DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
                DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
                DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
            }
        }
    }
}
else if (room == rTheKind)
{
    DrawFirstShopButton("Assorted Petitioners", "The Kind offer goods in exchange for your wisdom.", 1)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 77, "They can look at them burning for hours on end.", 26, 3, "ICanBuyForApprehensions")
        DisplaySecondItem(0, 73, "They are well accustomed to darkness and know how to gather it.", 68, 10, "ICanBuyForApprehensions")
        DisplayThirdItem(0, 99, "The clan hides a lot of wondrous items and very reluctant to part with them.", 100, 20, "ICanBuyForApprehensions")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rTheBrite)
{
    DrawFirstShopButton("Greasy's Griddled Squids", "Greasy is an uncomplicated man who lives up to his name. He is passionate about squids.", 1)
    if (FirstShopButtonPressed == 1)
        DisplayFirstItem(0, 50, "Greasy doesn't accept honest Civean guineas. He'll give you one of his squids in exchange for your knowledge.", 12, 3, "ICanBuyForApprehensions")
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rTheMute)
{
    DrawFirstShopButton("Inktooth the Elder", "Inktooth has somehow got a hold of some Civean guineas, and he seems amused that you will give him valuable words in exchange for small circles made of a useless alloy.", 1)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 36, "Inktooth reads through the tome with immense solemnity, and counts out the coins he is willing to give you.", 80, 45, "ICanOnlySell")
        DisplaySecondItem(0, 34, "The old man shakes his head in wonder, seemingly overawed by the beauty of the poems. You even hear a quiet sigh escape his stitched lips.", 60, 36, "ICanOnlySell")
        DisplayThirdItem(0, 33, "Inktooth's face betrays no emotion. He reads through the first chapters of the book with unnatural speed, then counts out the coins he is willing to offer.", 40, 30, "ICanOnlySell")
        DisplayFourthItem(0, 35, "Inktooth flips through the book, grinning and raising his eyebrows and gesturing enthusiastically.", 85, 70, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rIcicleSpine)
{
    DrawFirstShopButton("Bin Bin Sha's Workshop", "A squat blue mycena who actually speaks at a normal speed, despite the extreme cold. It seems to fancy itself an inventor and entrepreneur, and offers to upgrade your kinetopede's legs.", 1)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFuelItem("Bin Bin Sha has an immense stockpile of coal and fossil-ghosts. It says it scavenged them from vehicles nearby whose crews froze to death.", 40, 15)
        if (HasLegsComponent(4) == 0)
            DisplaySecondEngineUpgradeItem("Legs", 4, "Bin Bin Sha raps his spongy fist on one of the legs. " + '"' + "I can slap something on these that'll have them gliding on top of the snow, not ploughing through it." + '"' + "##(Increases kinetopede speed by 30%, not affected by swamp and snow.)", 3200)
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rMergulus)
{
    DrawFirstShopButton("Knackers' Yard", "The Shambles carves the air behind you. Gods are flensed here, before they are dragged still-living into the patient machine.", 1)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFuelItem("The Shambles have to run on something.", 30, 10)
        if (WeaponBayReturnNumberOfItems(6) != 4)
            DisplaySecondEngineUpgradeItem("Weapon Bay", 6, "It fell from the Shambles the other day. No-one can remember installing it.##(Life damage, no Hull damage. Perfect accuracy.)", 8600)
        DisplayThirdItem(0, 94, "The knackers are very interested in buying this from you. They glide toward you en masse.", 1700, 920, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rByssus)
{
    DrawFirstShopButton("Hall of Wonders", "Boasts the best of the Empire's marvels, innovations, triumphs. And always on the lookout for more.", 1)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 99, "Another treasure to add to the hoard.", 2500, 1250, "ICanOnlySell")
        DisplaySecondItem(0, 41, "The Hallkeepers murmur with pleasure.", 1000, 600, "ICanOnlySell")
        DisplayThirdItem(0, 70, "The Hallkeepers grin unnervingly.", 1000, 550, "ICanOnlySell")
        DisplayFourthItem(0, 78, "When you present the Device, the Hallkeepers smile. They don't seem to realize it won't work outside the City of Engines.", 680, 350, "ICanOnlySell")
    }
    DrawSecondShopButton("Rational Man's Marketplace", "Even an unthreaded foreigner such as yourself is able to trade here. But only under close supervision and at unfavourable rates.", 0)
    if (SecondShopButtonPressed == 1)
    {
        if (HasArmourComponent(4) == 0)
            DisplayEngineUpgradeItem("Armour", 4, "Apparently, theurgic steel is the absolute best defence when battling a god.##(Increases Hull strength by 120, reduces sanity loss, and resists occult weaponry.)", 5200)
        DisplaySecondItem(0, 44, "It is in shorter supply ever since the construction of New Draden.", 200, 120, "ICanBuyAndSell")
        DisplayThirdItem(0, 92, "The only metal that can withstand the wrath of the gods.", 460, 400, "ICanBuyAndSell")
        DisplayFifthItem(0, 88, "A gift from above and below.", 1500, 602, "ICanOnlyBuy")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawThirdShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawThirdShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawThirdShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rFilimenor)
{
    DrawFirstShopButton("Valorous Man's Hospital", "You will never forget the screams of the Vessels, to which as little attention is paid as to the squealing of pigs.", 1)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 65, '"' + "We use it to silence the screams," + '"' + " the nurse tells you. " + '"' + "During special occasions, when we need quiet." + '"', 90, 70, "ICanBuyAndSell")
        DisplaySecondItem(0, 66, '"' + "A sleeping Vessel works just as well as a woken one," + '"' + " you are told. " + '"' + "Though they make less music." + '"', 80, 45, "ICanBuyAndSell")
        DisplayThirdItem(0, 23, '"' + "We are always in need of another Vessel." + '"', 380, 165, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rNewDraden && oInventories.NumberOfTimesVisitedNewDraden == 0)
{
    DrawFirstShopButton("The Halfway House", "A shop half-real, half-mirrored. You must pass between the two to see all the wares, and the sensation is unpleasant. This boundary should not be violated so routinely.", 1)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 91, "As common as brick.", 100, 50, "ICanOnlyBuy")
        DisplaySecondItem(0, 44, "From which fetch-mirrors are made.", 70, 30, "ICanOnlyBuy")
        DisplayThirdItem(0, 32, "Inherited from the libraries of old.", 130, 100, "ICanOnlyBuy")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rBladRaddock)
{
    DrawFirstShopButton("The Red Cave", "A woman with many missing fingers sells what she pulled from the mountain.", 1)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 31, "A tasty little dumpling.", 45, 25, "ICanBuyForApprehensions")
        DisplaySecondItem(0, 89, '"' + "Eat like a pig," + '"' + " she croaks.", 45, 20, "ICanBuyForApprehensions")
        DisplayThirdItem(0, 73, '"' + "It pools in the cavities after we rip the guts out," + '"' + " she says, leering.", 45, 260, "ICanBuyForApprehensions")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rWordhuntersHearth)
{
    DrawFirstShopButton("The Trophy Room", "A gap-toothed old man shows you the words he's killed. He offers you one in exchange for some of what you've learned.", 1)
    if (FirstShopButtonPressed == 1)
        DisplayFirstItem(0, 56, "A slaughtered word, impaled on a stick.", 22, 11, "ICanBuyForApprehensions")
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rJabad)
{
    DrawFirstShopButton("Pipe Nine", "Jabadeers shoot down Pipe Nine conducting business at lightning speed. They understand that foreigners may take several trips up and down before they finish negotiating a transaction.", 1)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 77, "Many pipes are unlit inside, so a pack of flares is a must.", 15, 30, "ICanBuyForApprehensions")
        DisplaySecondItem(0, 84, "They never leave their pipes without a trusty rifle. All of their bullets are hand-made.", 45, 90, "ICanBuyForApprehensions")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rCalaram)
{
    if (global.ConcernsConcludedFlag[48] == 4 || global.ConcernsConcludedFlag[48] == 5)
    {
        DrawFirstShopButton("Conjholl Bazaar", "A feast for the eyes - acrobats, elephants, juggling apes, spinning wheels that pour columns of honey through complex machines to produce music and make puppets dance. The smell makes you sick.", 1)
        if (FirstShopButtonPressed == 1)
        {
            DisplayFuelItem("It's fairly difficult to acquire fuel in the Confectorate.", 60, 14)
            DisplaySecondItem(0, 103, "Extravagant local drink aged in the innards of preserved cadavers.", 80, 45, "ICanBuyAndSell")
            DisplayThirdItem(0, 101, "Helps with the unbearable smell.", 140, 75, "ICanBuyAndSell")
            DisplayFourthItem(0, 104, "Handle with care, or it will blow you to smithereens.", 300, 150, "ICanBuyAndSell")
            DisplayFifthItem(0, 62, "Sweet tasty treat from wasp domain. After the rebellion in Scornvaunt, the price for it doubled.", 400, 220, "ICanOnlySell")
            DisplaySixthItem(0, 85, "Sometimes used for tomb-building.", 400, 240, "ICanOnlySell")
        }
    }
    else
    {
        DrawFirstShopButton("Conjholl Bazaar", "A feast for the eyes - acrobats, elephants, juggling apes, spinning wheels that pour columns of honey through complex machines to produce music and make puppets dance. The smell makes you sick.", 1)
        if (FirstShopButtonPressed == 1)
        {
            DisplayFuelItem("It's fairly difficult to acquire fuel in the Confectorate.", 110, 14)
            DisplaySecondItem(0, 103, "Extravagant local drink aged in the innards of preserved cadavers.", 80, 45, "ICanBuyAndSell")
            DisplayThirdItem(0, 101, "Helps with the unbearable smell.", 140, 75, "ICanBuyAndSell")
            DisplayFourthItem(0, 104, "Handle with care, or it will blow you to smithereens.", 300, 150, "ICanBuyAndSell")
            DisplayFifthItem(0, 62, "Sweet tasty treat from wasp domain.", 200, 110, "ICanOnlySell")
            DisplaySixthItem(0, 85, "Sometimes used for tomb-building.", 400, 240, "ICanOnlySell")
        }
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rAffina)
{
    DrawFirstShopButton("Aniseed Passage", "A subterranean tunnel lined with contorted statues carved from boiled black sugar, sweating and melting and twisting further as they melt. Between them are cross-legged merchants in dark robes and hoods. They thrust their wares toward you in silence.", 1)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(1, 19, "They are keen to listen to stories of other worlds. Is that a wisp of steam emerging from the depths of the hood?", 110, 80, "ICanOnlySell")
        DisplaySecondItem(1, 5, "Your joke is met with chill silence. But they pay you all the same.", 120, 75, "ICanOnlySell")
        DisplayThirdItem(2, 0, "Place your ear very close to that empty hood, and listen to a whispered secret.", 600, 110, "ICanBuyAndSell")
        DisplayFourthItem(0, 96, "Dozens of stoppered clay jars, filled with ghost-matter.", 120, 80, "ICanBuyAndSell")
        DisplayFifthItem(0, 101, "A clanking assortment of liquorice-scented vials.", 100, 70, "ICanBuyAndSell")
        DisplaySixthItem(0, 92, "Twisted, misshapen lumps of warding iron.", 400, 285, "ICanBuyAndSell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here? On the cover is a painted purple eye.", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but some of the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawSecondShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}
else if (room == rMakkera)
{
    DrawFirstShopButton("Survivors' Collective", "They just want to rebuild.", 1)
    if (FirstShopButtonPressed == 1)
    {
        DisplayFirstItem(0, 60, "The survivors gather around the timber, excitedly discussing plans for new bridges across the treacle.", 80, 40, "ICanOnlySell")
        DisplaySecondItem(0, 98, "Stone, to build sturdy new buildings above the flood! The survivors' plans seem almost grandiose, given their predicament.", 160, 100, "ICanOnlySell")
        DisplayThirdItem(0, 93, '"' + "Everything tastes sweet," + '"' + " says a survivor bitterly. " + '"' + "We will pay anything for a different taste." + '"', 120, 100, "ICanOnlySell")
    }
    if (oPlayer.SanityRemaining <= 20 && (oPlayer.InsanityType < 2 || oPlayer.InsanityType > 7))
    {
        DrawSecondShopButton("Strange Little Shop", "It has been here a long time.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 0, "The young man behind the desk regards you with a polite smile. " + '"' + "Good bones, these. Bones from good, kind men." + '"', 30, 10, "ICanOnlyBuy")
            DisplaySecondItem(0, 43, '"' + "Have you ever seen such a thing? The teeth, the eyes, the absent face? A good, kind god, this was." + '"', 75, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 87, '"' + "It is nothing but itself. You must respect it." + '"' + " The young man shakes his head admiringly.", 195, 100, "ICanOnlyBuy")
            DisplayFourthItem(1, 18, '"' + "For a small sum, I will whisper," + '"' + " the young man says. " + '"' + "I do not know what I will say." + '"', 80, 40, "ICanOnlyBuy")
        }
    }
    else if (oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 7)
    {
        DrawSecondShopButton("Nameless Library", "The architecture is unfamiliar. There is a sign on the wall in archaic Civean, urging you to speak your prayers aloud. There is no-one inside, but some irresistible instinct compels you to leave your money at the counter.", 1)
        if (SecondShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 53, "Dust billows. How long was this sitting here?", 160, 80, "ICanOnlyBuy")
            DisplaySecondItem(0, 37, "The language is foreign to you, but the gods and the symbols are familiar.", 62, 30, "ICanOnlyBuy")
            DisplayThirdItem(0, 74, "The shelves are filled with holy books for unknown gods.", 62, 30, "ICanOnlyBuy")
            DisplayFourthItem(4, 24, "The shop sells not just books, but clocks. Each one appears frozen in time. When you pick one up, you think you feel timeless eyes focus on you.", 1000, 62, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawThirdShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
    else if (oInventories.MadnessMuseumExists == 1 && oPlayer.SanityRemaining <= 20 && oPlayer.InsanityType == 6)
    {
        DrawThirdShopButton("The Museum of Unnatural Curiosity", "Professor Elga Pewt greets you in the lobby. Ambrose's head sits in a jar on her desk. There are more exhibits than you remember.", 1)
        if (ThirdShopButtonPressed == 1)
        {
            DisplayFirstItem(0, 13, '"' + "This is all of them that remains," + '"' + " says Elga. Her mascara is smeared. Has she been weeping?", 200, 100, "ICanOnlyBuy")
            DisplaySecondItem(0, 41, '"' + "Take this off my hands, I beg you. I have too many now." + '"', 1000, 500, "ICanOnlyBuy")
            DisplayThirdItem(0, 75, '"' + "The Museum goes where it wills, and I go with it." + '"' + " Elga sighs. " + '"' + "I meet no shortage of murderers. I harvest from them when I can." + '"', 400, 200, "ICanOnlyBuy")
            DisplayFourthItem(0, 9, '"' + "I will sell you a Key." + '"' + " Her eyes are empty. " + '"' + "I lose track of which Doors are locked anyway. I have lived a thousand cycles." + '"', 5000, 4000, "ICanOnlyBuy")
            DisplayFifthItem(0, 88, '"' + "Veins from beneath, pumping black ichor into the hearts of its puppets." + '"', 1305, 602, "ICanOnlyBuy")
            DisplaySixthItem(2, 19, '"' + "I have learned much since we met." + '"' + " Her dark eyes are hollow. " + '"' + "Telling you will be no kindness." + '"', 4000, 1000, "ICanOnlyBuy")
        }
    }
}