if (BoxMode == "Event")
            oPlayer.LastVisitedForSavePurposes = "Pannachak"
            FileSelected = "SaveFile0.homd"
        else if (DialogueScreen == "FirstScreen")
                ("P")
                ("ANNACHAK")
                ("You are greeted by a forest of rotted corpses, skewered haphazardly on iron spikes. Loops of wire twist their sunken heads to face you.")
                ("Each cadaver in this thicket of the dead has a sign strung around its throat. Each faded wooden board has been etched with tiny words.")
                ("In the distance, a huge skeletal structure. Wisps of smoke curl to the ceiling. People live here.")
                    (("New location visited. " + ApprehensionsString), "Logbook", 4)
                        FileSelected = "SaveFile0.homd"
                    ("Examine the corpses more closely.", "You will have to approach on foot.", "")
                ("Scurry along.", "Good things rarely come from investigating corpses.", "[You will arrive in Pannachak.]")
                ("P")
                ("ANNACHAK")
                ("Forests of friendly corpses greet the newcomer. Beyond that, brown-yellow mists swirl around the legs of a creaking iron edifice, tall enough to scrape the ceiling. Huts of salvaged metal nestle in its shadow.")
                    if (oPlayer.Lightbearer == "Panorama Volt")
                        NeedsCargoItem("Dive into Panorama's memories.", "", (((("[Requires x1 Dreamsalve and x1 Empty Memory-box. You currently have x" + string(CargoReturnNumberOfItems(90))) + " Empty Memory-boxes and x") + string(CargoReturnNumberOfItems(1))) + " Dreamsalve.]")0, 0.8, HasDreamAndBox)
                    if (oPlayer.Lookout == "Violante DiMar")
                        ("Send Violante into hiding.")
                if (oInventories.ViolanteHiding == "Pannachak" && global.Pannachak1 == 0)
                    ("Visit Violante DiMar.", "She's hiding out in one of the rusty huts.")
                    ("Ask the villagers about Lord Phosphorus Crumpett.")
                    ("Ask to speak to Mayor Feverbeard.", "The villagers quail before you and stammer directions.")
                    ("Find somewhere to rest.", "It's been a long journey.", "[This will recover some of your Sanity.]")
                    NeedsRelationshipsItem("Gather news.", "The villagers of Pannachak slip away whenever you approach them. You wonder how much actually happens here.", "[Requires x1 Pannachak Familiarity.]", HasFam)
                if (oPlayer.LastVisited != "Pannachak" && (!ConcernsReturnNumberOfItems(116)) && global.ConcernsConcludedFlag[45] == 0)
                        ("A summons from Mayor Feverbeard.", "He is in need of your help.")
                    else ("The villagers come to you, heads bowed.", "They are in need of your help.")
                if (ConcernsCheckForSpecificItem(116) == 1 && oPlayer.LastVisited != "Pannachak" && global.Pannachak2 == 0 && global.ConcernsConcludedFlag[45] == 0)
                    ("Explore the Svadilfari.", "A brutish iron hulk. It sighs in the wind.", "")
                if (oPlayer.LastVisited != "Pannachak" && global.Pannachak3 == 0)
                    ("A village competition.", "Pannachak takes great pride in its community spirit, although they're too shy around strangers to talk much about it. Perhaps you can gain their trust by entering one of their innumerable competitions.", "")
                    ((("Preach the word of " + oInventories.GodNameForMissionaryWork) + "."), "A few villagers come to watch you, their curiosity winning out over fear.", "")
                ("Leave.")
                ("Inside the kinetopede.", "Here you can find all miscellaneous options.")
        else if (DialogueScreen == "SecondScreen" && AdvancingToVillage == 1)
            ("P")
            ("ANNACHAK")
            ("Brown-yellow mists swirl around the legs of a creaking iron edifice, tall enough to scrape the ceiling. Huts of salvaged metal nestle in its shadow.")
            ("There are faces peeking between the rusted girders.")
                if (oPlayer.Lightbearer == "Panorama Volt")
                    NeedsCargoItem("Dive into Panorama's memories.", "", (((("[Requires x1 Dreamsalve and x1 Empty Memory-box. You currently have x" + string(CargoReturnNumberOfItems(90))) + " Empty Memory-boxes and x") + string(CargoReturnNumberOfItems(1))) + " Dreamsalve.]")0, 0.8, HasDreamAndBox)
                ("Ask the villagers about Lord Phosphorus Crumpett.")
            if (oInventories.TakeViolantePannachak == 1 && oPlayer.LastVisited != "Pannachak" && ConcernsReturnNumberOfItems(90) == 3)
                if (oPlayer.Lookout == "Violante DiMar")
                    ("Send Violante into hiding.")
            if (oInventories.ViolanteHiding == "Pannachak" && global.Pannachak1 == 0)
                ("Visit Violante DiMar.", "She's hiding out in one of the rusty huts.")
                ("Ask to speak to Mayor Feverbeard.", "The villagers quail before you and stammer directions.")
                ("Find somewhere to rest.", "It's been a long journey.", "[This will recover some of your Sanity.]")
                NeedsRelationshipsItem("Gather news.", "The villagers of Pannachak slip away whenever you approach them. You wonder how much actually happens here.", "[Requires x1 Pannachak Familiarity.]", HasFam)
            if (oPlayer.LastVisited != "Pannachak" && (!ConcernsReturnNumberOfItems(116)) && global.ConcernsConcludedFlag[45] == 0)
                    ("A summons from Mayor Feverbeard.", "He is in need of your help.")
                else ("The villagers come to you, heads bowed.", "They are in need of your help.")
            if (ConcernsCheckForSpecificItem(116) == 1 && oPlayer.LastVisited != "Pannachak" && global.Pannachak2 == 0 && global.ConcernsConcludedFlag[45] == 0)
                ("Explore the Svadilfari.", "A brutish iron hulk. It sighs in the wind.", "")
            if (oPlayer.LastVisited != "Pannachak" && global.Pannachak3 == 0)
                ("A village competition.", "Pannachak takes great pride in its community spirit, although they're too shy around strangers to talk much about it. Perhaps you can gain their trust by entering one of their innumerable competitions.", "")
                ((("Preach the word of " + oInventories.GodNameForMissionaryWork) + "."), "A few villagers come to watch you, their curiosity winning out over fear.", "")
            ("Leave.")
            ("Inside the kinetopede.", "Here you can find all miscellaneous options.")
        else if (DialogueScreen == "SecondScreen" && InvestigatingCorpses == 1)
            ("P")
            ("ANNACHAK")
            ("The scratched writing on the signs is tiny and illegible. You have to get closer than you'd like.")
            ("'A SMALL TOWN WITH A BIG HEART,' says the first sign. The second says 'NOTHING WRONG WITH BEING FRIENDLY!!!'")
            ("'WELCOME TO PANNACHAK,' says the third.")
            ("Gained x1 Disquieting Incident", "Logbook", 3)
            ("Make your way to Pannachak.", "Well. That clears everything up.", "")
        else if (DialogueScreen == "SecondScreen" && MissionaryPreaching == 1)
            ("As you speak, your small audience drift away in dribs and drabs. You are left with one lone watcher, who shrieks and runs away as soon as you approach him.")
            ("Pack up your things.", "Somewhere else will accept your god; keep looking.", "")
        else if (DialogueScreen == "SecondScreen" && LeavingTheCity == 1 && TooHeavyToLeaveTheCity == 0)
            ("I")
            ("NTO THE DARK")
            ("Which direction will you go?")
            ("On second thoughts...", "There are matters here that still merit attention.", "#"0, 0.8)
            ("Pore over the map.", "Orient yourself before you launch off into the ravenous dark.")
                    BoxMode = "Map"
            ("North.", "A wall of locked doors. Insurmountable.")
                oPlayer.LastVisited = "Pannachak"
                LeavingSpecialRoomDialogueBox("North")
            ("West.", "Vast field of snow, ice and frozen ruins.")
                oPlayer.LastVisited = "Pannachak"
                LeavingSpecialRoomDialogueBox("West")
            ("East.", "To a slum-city, where jesters and beggars try to survive.")
                oPlayer.LastVisited = "Pannachak"
                LeavingSpecialRoomDialogueBox("East")
            ("South.", "Unfinished statue of a monstrous person.")
                oPlayer.LastVisited = "Pannachak"
                LeavingSpecialRoomDialogueBox("South")
        else if (DialogueScreen == "SecondScreen" && LeavingTheCity == 1 && TooHeavyToLeaveTheCity == 1)
        else if (DialogueScreen == "SecondScreen" && PanoramaQuest == 1)
        else if (DialogueScreen == "SecondScreen" && ViolanteQuest == 1)
        else if (DialogueScreen == "SecondScreen" && EmpireQuest == 1)
        else if (DialogueScreen == "SecondScreen" && WanderTheStreets == 1)
                ("P")
                ("ANNACHAK")
                ("The current competition is flower-arranging, although Pannachak lacks vegetation. The villagers' improvised solution is to see who can sort shards of rusty salvage into the most pleasing arrangement.")
                ("An earnest attempt.", "Create the best arrangement you can.", "Graft", 19)
                ("Just throw something together.", "The villagers clearly don't take this very seriously. One of them has just arranged his salvage into a crude smiley face and called it a day.", "")
                ("P")
                ("ANNACHAK")
                ("Today's competition is corpse decoration. Addressing the contestants, Mayor Feverbeard informs you that corpses are awarded prizes based on five criteria:")
                ("- The friendliness of their welcome sign.")
                ("- The politeness of their demeanour.")
                ("- The stylishness of their dress.")
                ("- Most effective concealment of odour.")
                ("- Outrageousness.")
                ("You are handed a mostly-rotten old man and a box of jaunty hats.")
                ("Gained x1 Reflection on Mortality", "Logbook", 3)
                ("Make an honest attempt.", "Pinch your nose...", "Insight", 50)
                ("No, thank you.", "This is just too strange. And the stench -!", "")
        else if (DialogueScreen == "SecondScreen" && GatheringNews == 1)
            ("T")
            ("HE LATEST GOINGS-ON")
            News1 = "Another piece of metal fell off the Svadilfari. The salvage is going to be used to build a school."
                    News2 = "The Chimeric Empire sent another mayor to replace Feverbeard, but he seems to have vanished. A dancing competition was held recently and won by a lovely young couple who everyone suspects will get married soon."
                    News2 = "The collapse of the Empire has been celebrated with fireworks. A dancing competition was held recently and won by a lovely young couple who everyone suspects will get married soon."
                News2 = "The Chimeric Empire sent a new mayor to replace the deceased Feverbeard. The replacement was immediately tarred and feathered and thrown off the oil rig."
                News3 = "Ghostly wails were heard from the Svadilfari recently. Mayor Feverbeard declared another civic holiday in his honour. The Council recently elected to declare Pannachak 'The Best Village In The House.'"
                News3 = "Ghostly wails were heard from the Svadilfari recently. The Council recently elected to declare Pannachak 'The Best Village In The House.'"
            News4 = "The supply of oil from the Svadilfari has been dwindling. A team of engineer-warriors were sent to investigate possible mechanical faults, and have yet to return."
                    News5 = "Pannachak's latest sculpture competition is over, and Mayor Feverbeard declared all contestants winners. In a tragic accident, the latest tax-collector from the Empire was found sewn inside a sack and drowned in crude oil."
                    News5 = "Pannachak's latest sculpture competition is over, and Mayor Feverbeard declared all contestants winners. Mayor Feverbeard has declared Pannachak a free village, no longer controlled by any Empire."
                News5 = "Another day of mourning declared for Mayor Feverbeard. The villagers have done very little since he died but wail and build statues in his honour."
            News6 = "A black-stained note has been delivered through the Svadilfari's pipes along with the latest batch. 'PLEASE STOP TAKING OUR OIL,' it says. 'OUR PLANET IS DYING.' Attempts to send a polite reply have failed."
            ("You manage to corner a townsperson, who gabbles a dozen greetings to you in a dozen languages. When he realizes that you just want to hear what's happened lately in Pannachak, he sags in relief.")
            ("Gained x1 Current Affairs: Pannachak", "Logbook", 4)
            ("Well, well.", "A small town with a big heart.", "#")
        else if (DialogueScreen == "SecondScreen" && RecoveringSanity == 1)
            ("A")
            (" BRIEF RESPITE")
            ("All the houses are identical heaps of iron, but one has the word 'INN' scratched in tiny writing on a sign outside.")
            ("The innkeeper stares at you in terrified awe, and tells you that you can rest here as long as you want. All he has on tap is crude oil, which he warns you is an acquired taste.")
            ("Your Sanity recovers slightly.", "Sanity", 1)
            ("You spent 1 day at Pannachak.", "Time", 0)
            ("You feel better already.", "It's an odd, quiet place, but it seems very safe.", "#")
        else if (DialogueScreen == "SecondScreen" && PioneerQuest == 1)
        else if (DialogueScreen == "SecondScreen" && ExploringSvadilfari == 1)
        else if (DialogueScreen == "SecondScreen" && MiscellaneousEvent == 1)
        else if (DialogueScreen == "SecondScreen" && MiscOptions == 1)
            ("C")
            ("APTAIN'S QUARTERS")
            ("The machine greets you with a steady, soothing hum. In your quarters, you can safely decide what side activity to pursue. Deal with prisoners? Drink something? Operate on your own memories, perhaps?")
            ("Return to location.", "")
        else if (DialogueScreen == "ThirdScreen" && EarnestAttempt == 1 && WasChallengeSuccessful == 1)
            ("P")
            ("ANNACHAK")
            ("You work through the night, assembling your rust-splotched metal into a magnificent diorama, a scale-perfect model of Pannachak itself, complete with a Svadilfari that belches flame via an elaborate mechanism hidden in the base.")
                ("The other villagers mostly just throw their stuff together at random. Mayor Feverbeard declares all the participants victors, and gives each of you a certificate.")
                ("The other villagers mostly just throw their stuff together at random. The judge declares all the participants victors, and gives each of you a certificate.")
            ("Gained x1 Moment of Melancholy", "Logbook", 3)
            ("+1 Pannachak Familiarity", "Reputation", 5)
            ("(You passed a Graft challenge!)", "Challenge", 6)
            ("A... certificate...?", "The other contestants are already enthusiastically destroying their sculptures.", "")
        else if (DialogueScreen == "ThirdScreen" && (ThrowTogether == 1 || (EarnestAttempt == 1 && WasChallengeSuccessful == 0)))
            ("P")
            ("ANNACHAK")
            ("You throw the bits of rusty metal together as best you can, and the other villagers do the same.")
                ("Mayor Feverbeard declares all the participants victors, and gives each of you a certificate. The villagers congratulate you shyly - a foreigner doing as well as Pannachak natives, they declare, is a very difficult task and something you should be proud of.")
                ("The judge declares all the participants victors, and gives each of you a certificate. The villagers congratulate you shyly - a foreigner doing as well as Pannachak natives, they declare, is a very difficult task and something you should be proud of.")
            ("+2 Pannachak Familiarity", "Reputation", 5)
                ("(You passed a Graft challenge!)", "Challenge", 6)
            ("Well. You got a certificate.", "The villagers run away if you try to further the conversation.", "")
        else if (DialogueScreen == "ThirdScreen" && CorpseDecoration == 1)
            ("P")
            ("ANNACHAK")
            ("You fish out the most outrageous hat you can find, and apply make-up to the old man's face. " + '"' + "Don't apply too much mascara, or the maggots will burst from his eyes," + '"' + " advises a fellow competitor. You nod.")
            ("Perfumes and spices to mask the scent, a fashionable scarf - what are you missing? Ah, yes.")
            ("What will you write on the corpse's sign? You need to strike a delicate balance between friendliness and 'outrageousness,' whatever that means.")
            ("WELCOME TO PANNACHAK.", "", "")
                SignString = "WELCOME TO PANNACHAK"
                WinningCategory = "Politeness"
            ("HELLO TRAVELLER! DON'T WORRY: PEOPLE HERE ARE QUITE NICE DESPITE THE CORPSE THING.", "", "")
                SignString = "HELLO TRAVELLER! DON'T WORRY: PEOPLE HERE ARE QUITE NICE DESPITE THE CORPSE THING."
                WinningCategory = "Friendliness"
            ("Just draw a smiley face.", "", "")
                SignString = ":)"
                WinningCategory = "Friendliness"
            ("A TOWN WITH ESPRIT DE CORPSE", "", "")
                SignString = "A TOWN WITH ESPRIT DE CORPSE"
                WinningCategory = "Stylishness"
            ("HOT HOT! SO SPICY!", "", "")
                SignString = "HOT HOT! SO SPICY!"
                WinningCategory = "Outrageousness"
            ("''DEAD(!)'' PLEASED TO SEE YOU.", "", "")
                SignString = "''DEAD(!)'' PLEASED TO SEE YOU."
                WinningCategory = "Outrageousness"
            ("RUN.", "", "")
                SignString = "RUN."
                WinningCategory = "Outrageousness"
            ("Suddenly realize what you are doing.", "The people of Pannachak watch you curiously as you get up and leave.", "")
        else if (DialogueScreen == "ThirdScreen" && FinishCorpse == 1)
            ("P")
            ("ANNACHAK")
            ((("You step back to admire your handiwork: a decayed figure, skin ragged with decay, a stake fixing it upright. '" + SignString) + ",' reads the sign around its neck."))
                ('"' + "Excellent corpsework, all," + '"' + " booms Mayor Feverbeard from his rusted podium. " + '"' + "You're all winners, of course, and you will all receive certificates. But I will award an extra-special prize to the best of the best!" + '"')
                ('"' + "Excellent corpsework, all," + '"' + " booms the judge from his rusted podium. " + '"' + "You're all winners, of course, and you will all receive certificates. But I will award an extra-special prize to the best of the best!" + '"')
                ((("In the end, your corpse wins the " + WinningCategory) + " prize - which turns out to be a differently-coloured certificate. But a foreigner winning a prize in corpse decoration is apparently a wondrous unlikelihood, and the Pannachak villagers promise that they'll be talking about it for months."))
                ("+2 Pannachak Familiarity", "Reputation", 5)
                ("Your corpse is given pride of place amongst the greeters.", (("For years, travellers will be met with its grinning face and '" + SignString) + ".'"), "")
                ("In the end, your corpse does not win a special prize - although the special prize seems to only be a differently-coloured certificate. Still, a foreigner competing in the corpse decoration contest is a notable occurrence, and the people of Pannachak seem to be spending longer in your company before running away.")
                ("+1 Pannachak Familiarity", "Reputation", 5)
                ("Your corpse is put at the back of the crowd.", "Only a determined traveller would see its message.", "")
        else if (DialogueScreen == "LastScreen")
            ("T")
            ("EST")
            ("Successful test.")
            ("Return.", "", "")
    draw_text(((view_wport[(0 << 0)] * 0.5) - 3), ((view_hport[(0 << 0)] * 0.75) - 3), "Pannachak")
    draw_text((view_wport[(0 << 0)] * 0.5), (view_hport[(0 << 0)] * 0.75), "Pannachak")
