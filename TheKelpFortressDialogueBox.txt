if (BoxMode == "Event")
            oPlayer.LastVisitedForSavePurposes = "The Kelp Fortress"
            FileSelected = "SaveFile0.homd"
        else if (DialogueScreen == "FirstScreen")
                ("T")
                ("HE KELP FORTRESS")
                    ("A grimy citadel with walls of sea-starved kelp, every strand brown and withered. The carchar summon salt-water from other worlds to try to keep it alive, but there is never enough.")
                    ("A grimy citadel with walls of sea-starved kelp, every strand brown and withered. The carchar summon salt-water from other worlds to try to keep it alive, but there is never enough.")
                    ("Shackled carchar-slaves labour at the Fortress gates, building a statue in Atheling's honour.")
                    ("A grimy citadel with walls of lush green kelp. The floor is flooded with brine. High above the Saltcove Queen floats, a creature the size of a kingdom, its thousands of tentacles caressing the Fortress like a lover.")
                if NextButton("Plucked from oceanic worlds, most carchar accept their lives as second-class citizens in landbound cities. Here, though, the orthodox and the elite cling to tradition.", 1)
                        (("New location visited. " + ApprehensionsString), "Logbook", 4)
                            FileSelected = "SaveFile0.homd"
                        ("Receive your reward from the Saltcove Queen.")
                        ("Receive your reward from Atheling, the new Hammerhead Emperor.")
                        if (oPlayer.Recordkeeper == "Penpusher")
                            ("Ask around about Penpusher's past.")
                        if (oPlayer.Lightbearer == "Otto Von Honbach")
                            ("Help Otto capture an ichthyid hound.")
                        if (oPlayer.ChiefEngineer == "Lucetta Quetzl")
                            ("Return Librosteus's deck of black cards to the carchar.", "", "[Requires x1 Cards of Librosteus.]"0, 0.8)
                    if (ConcernsReturnNumberOfItems(127) == 3 && oPlayer.Navigator == "Peter McNally")
                        ("Hand Peter McNally over to the carchar for study.", "Don't mention the scorpiopede you destroyed.")
                        ("Pick up Peter as you promised.", "The Hammerheads should have finished their studies by now.")
                    if (oPlayer.LastVisited != "The Kelp Fortress" && global.KelpFortress1 == 0)
                        ("Wander the permitted districts.", "Non-carchar are only allowed in certain areas of the citadel. Further in, you are liable to be devoured.", "")
                        NeedsMoney("Repair your hull.", "A carchar named Metal-biter hangs around in the human-permitted district, fixing kinetopedes for petty cash. He bends iron girders with his oversized jaws.", (("[This will cost you " + string(FixCost)) + " guineas.]"), FixCost)
                        ("Gather news.", "The carchar do not write, so all news travels by word of mouth.", "")
                        NeedsInformationItem("Study the carchar language.", "A blind old carchar offers to teach you if you take him to the City of Keys.", "[This option requires 40+ Esoterica.]", CanLearnLang)
                    if (oPlayer.LastVisited != "Kelp Fortress" && global.KelpFortress2 == 0 && ReputationReturnNumberOfItems(10) > 7)
                        ("You are invited to attend a Hammerheads' ball.", "The envelope is delivered by a Nameless carchar messenger.", "[This option is available because you have 8+ Reputation: Carchar.]")
                        ((("Preach the word of " + oInventories.GodNameForMissionaryWork) + "."), "The Hammerhead aristocracy hide in their towers of coral, and allow no foreigner to speak to them. The regular carchar, however, are more willing to listen.", "")
                        ("Drop off your passenger.", "", "")
                    ("Inside the kinetopede.", "Here you can find all miscellaneous options.")
                ("T")
                ("HE KELP FORTRESS")
                    ("A grimy citadel with walls of sea-starved kelp, every strand brown and withered. The carchar summon salt-water from other worlds to try to keep it alive, but there is never enough.")
                    ("A grimy citadel with walls of sea-starved kelp, every strand brown and withered. The carchar summon salt-water from other worlds to try to keep it alive, but there is never enough.")
                    ("Shackled carchar-slaves labour at the Fortress gates, building a statue in Atheling's honour.")
                    ("A grimy citadel with walls of lush green kelp. The floor is flooded with brine. High above the Saltcove Queen floats, a creature the size of a kingdom, its thousands of tentacles caressing the Fortress like a lover.")
                    if (oPlayer.Recordkeeper == "Penpusher")
                        ("Ask around about Penpusher's past.")
                    ("Receive your reward from the Saltcove Queen.")
                    ("Receive your reward from Atheling, the new Hammerhead Emperor.")
                    if (oPlayer.Lightbearer == "Otto Von Honbach")
                        ("Help Otto capture an ichthyid hound.")
                    if (oPlayer.ChiefEngineer == "Lucetta Quetzl")
                        ("Return Librosteus's deck of black cards to the carchar.", "", "[Requires x1 Cards of Librosteus.]"0, 0.8)
                if (ConcernsReturnNumberOfItems(127) == 3 && oPlayer.Navigator == "Peter McNally")
                    ("Hand Peter McNally over to the carchar for study.", "Don't mention the scorpiopede you destroyed.")
                    ("Pick up Peter as you promised.", "The Hammerheads should have finished their studies by now.")
                if (oPlayer.LastVisited != "The Kelp Fortress" && global.KelpFortress1 == 0)
                    ("Wander the permitted districts.", "Non-carchar are only allowed in certain areas of the citadel. Further in, you are liable to be devoured.", "")
                    NeedsMoney("Repair your hull.", "A carchar named Metal-biter hangs around in the human-permitted district, fixing kinetopedes for petty cash. He bends iron girders with his oversized jaws.", (("[This will cost you " + string(FixCost)) + " guineas.]"), FixCost)
                    ("Gather news.", "The carchar do not write, so all news travels by word of mouth.", "#")
                    NeedsInformationItem("Study the carchar language.", "A blind old carchar offers to teach you if you take him to the City of Keys.", "[This option requires 40+ Esoterica.]", CanLearnLang)
                if (oPlayer.LastVisited != "Kelp Fortress" && global.KelpFortress2 == 0 && ReputationReturnNumberOfItems(10) > 7)
                    ("You are invited to attend a Hammerheads' ball.", "The envelope is delivered by a Nameless carchar messenger.", "[This option is available because you have 8+ Reputation: Carchar.]")
                    ((("Preach the word of " + oInventories.GodNameForMissionaryWork) + "."), "The Hammerhead aristocracy hide in their towers of coral, and allow no foreigner to speak to them. The regular carchar, however, are more willing to listen.", "")
                    ("Drop off your passenger.", "", "")
                ("Inside the kinetopede.", "Here you can find all miscellaneous options.")
        else if (DialogueScreen == "SecondScreen" && LeavingTheCity == 1 && TooHeavyToLeaveTheCity == 0)
            ("I")
            ("NTO THE DARK")
            ("Which direction will you go?")
            ("On second thoughts...", "There are matters here that still merit attention.", "#"0, 0.8)
            ("Pore over the map.", "Orient yourself before you launch off into the ravenous dark.")
                    BoxMode = "Map"
            ("North.", "Miles and miles of snowy fields.")
                oPlayer.LastVisited = "The Kelp Fortress"
                LeavingSpecialRoomDialogueBox("North")
            ("West.", "Pirate-priests. Loud and obnoxious.")
                oPlayer.LastVisited = "The Kelp Fortress"
                LeavingSpecialRoomDialogueBox("West")
            ("East.", "Some goatfolk with questionable hobbies.")
                oPlayer.LastVisited = "The Kelp Fortress"
                LeavingSpecialRoomDialogueBox("East")
            ("South.", "Lands of the dead. Not for a warmblooded folks.")
                oPlayer.LastVisited = "The Kelp Fortress"
                LeavingSpecialRoomDialogueBox("South")
        else if (DialogueScreen == "SecondScreen" && FixHull == 1)
        else if (DialogueScreen == "SecondScreen" && HighRepEvent == 1)
        else if (DialogueScreen == "SecondScreen" && LeavingTheCity == 1 && TooHeavyToLeaveTheCity == 1)
        else if (DialogueScreen == "SecondScreen" && OttoQuest == 1)
        else if (DialogueScreen == "SecondScreen" && LucettaQuest == 1)
        else if (DialogueScreen == "SecondScreen" && PeterQuest == 1)
        else if (DialogueScreen == "SecondScreen" && PenpusherQuest == 1)
        else if (DialogueScreen == "SecondScreen" && SecondPenpusherQuest == 1)
        else if (DialogueScreen == "SecondScreen" && MissionaryPreaching == 1)
            ("By process of elimination, the Fortress contains only the most orthodox carchar. They still worship their tentacled sea-gods, the aberrant lords of their old world, and react to your preaching with roars of disapproval and the occasional hurled stone.")
            ("You are forced to beat a hasty retreat.")
            ("A narrow escape.", "Somewhere else will accept your god; keep looking.", "")
        else if (DialogueScreen == "SecondScreen" && DropOffPassenger == 1)
        else if (DialogueScreen == "SecondScreen" && WanderTheStreets == 1)
                ("T")
                ("HE KELP FORTRESS")
                ("A carchar bard is delivering a passionate performance of one of their hundreds of epic sagas. Every saga depicts the lives of a carchar ancestor, spanning everything from their martial prowess and heroic exploits to their marital misadventures and minor family disputes.")
                ("This particular saga describes the life of She-Who-Thirsts-For-Blood, a warrior whose fearsome nickname became ironic once she was cursed and became a vampire. Like all carchar sagas, it describes all the grisliest details in extensive, lip-smacking detail.")
                ("+1 Cultural Knowledge: Carchar", "Logbook", 4)
                ("Gained x1 Lurid Tale", "Logbook", 3)
                ("The audience whoop and cheer.", "This one's an old favourite.", "")
                ("T")
                ("HE KELP FORTRESS")
                ("A judgement is being delivered in the town square. A hulking carchar stands accused of attempting to give himself a Name. He roars and rattles his chains, protesting his innocence.")
                ("The judge is a Hammerhead, one of the carchar's ruling elite. " + '"' + "Nameless, I pronounce you Guilty," + '"' + " she pronounces, banging a gavel against her podium.")
                ("Most of the crowd are chanting for blood. The Hammerhead nods, and holds up her hand.")
                ("Stay and watch the execution.", "It's what drew such a crowd.", "")
                ("Return to the kinetopede.", "You have no desire to watch this unfold.", "")
        else if (DialogueScreen == "SecondScreen" && Execution1 == 1)
            ("T")
            ("HE KELP FORTRESS")
            ("The Hammerhead clenches her fist. The convicted criminal floats into the air, as though pulled by invisible string, and hovers there for a moment. Then he explodes, showering the bellowing gleeful crowd in viscera.")
            ("After that, show's over. The carchar pack up the public court for the day and shuffle off home. You're left wiping scraps of carchar off your collar and contemplating what just happened.")
            ("You feel mournful.", "Perhaps he was innocent. He certainly did not deserve to die.", "[You will gain x1 Moment of Melancholy.]")
            ("You hope you never end up like that.", "It looked like a horrible way to go.", "[You will gain x1 Reflection on Mortality.]")
            ("Ha ha! He exploded.", "Hilarious.", "[You will gain x1 Droll Recollection.]")
        else if (DialogueScreen == "SecondScreen" && GatheringNews == 1)
            ("T")
            ("HE LATEST GOINGS-ON")
                News1 = "The Hammerhead Lords have executed an apostate. The latest sea-summoning has failed. Another group of emigrants have left for the City of Keys."
                News2 = "A heretic cult uncovered. Several Hammerheads are revealed to have been infested by skullops. A political demonstration has led to violent recriminations."
                News3 = "Disease runs rampant in the kelp-halls. A blood-battle between two feuding family members has resulted in several casualties. More carchar visitants have arrived, confused and afraid."
                News1 = "Atheling has declared another cruel edict. The latest sea-summoning has failed. Another group of emigrants have left for the City of Keys."
                News2 = "A heretic cult uncovered. Several Hammerheads are revealed to have been infested by skullops. A political demonstration has led to violent recriminations."
                News3 = "Disease runs rampant in the kelp-halls. A blood-battle between two feuding family members has resulted in several casualties. More carchar visitants have arrived, confused and afraid."
                News1 = "The Saltcove Queen has slaughtered more Hammerheads, cementing her position. Despite the labours of her slaves, her attempts to escape the House and rejoin her Empire have failed."
                News2 = "The Saltcove Queen has slaughtered more Hammerheads, cementing her position. Despite the labours of her slaves, her attempts to escape the House and rejoin her Empire have failed."
                News3 = "The Saltcove Queen has slaughtered more Hammerheads, cementing her position. Despite the labours of her slaves, her attempts to escape the House and rejoin her Empire have failed."
            ("Gained x1 Current Affairs: The Kelp Fortress", "Logbook", 4)
            ("Well, well.", "You put away your notepad, and thank the carchar you were speaking to.", "")
        else if (DialogueScreen == "SecondScreen" && LearningCarchar == 1)
            ("A")
            ("N EDUCATION")
            ("The carchar grunts something that might be a thanks. He has grandchildren in the City, he says, and he no longer thinks them foolish for going there.")
            ("On the journey he teaches you a little of the language. It is dizzyingly complex, but you make some progress.")
            ("+1 Cultural Knowledge: Carchar", "Logbook", 4)
            ("Gained x1 Carchar Passenger, bound for the City of Keys", "Cargo", 3)
            ("+1 Reputation: Carchar", "Reputation", 5)
            ("The rules of the language are intricate.", "And each rule has more exceptions than adherents.", "")
        else if (DialogueScreen == "SecondScreen" && DropOffCarcharPassenger == 1)
            ("T")
            ("HE KELP FORTRESS")
            ("You drop off your carchar passenger, who regards the Kelp Fortress with an expression of profound disappointment.")
            ("If he is unsatisfied with the place, however, he does not say so aloud.")
            ("Gained 100 G", "Money", 1)
            ("He gives you your money and leaves.", "", "")
        else if (DialogueScreen == "SecondScreen" && MiscellaneousEvent == 1)
        else if (DialogueScreen == "SecondScreen" && MiscOptions == 1)
            ("C")
            ("APTAIN'S QUARTERS")
            ("The machine greets you with a steady, soothing hum. In your quarters, you can safely decide what side activity to pursue. Deal with prisoners? Drink something? Operate on your own memories, perhaps?")
            ("Return to location.", "")
        else if (DialogueScreen == "LastScreen")
            ("T")
            ("EST")
            ("Successful test.")
            ("Return.", "", "")
    draw_text(((view_wport[(0 << 0)] * 0.5) - 3), ((view_hport[(0 << 0)] * 0.75) - 3), "The Kelp Fortress")
    draw_text((view_wport[(0 << 0)] * 0.5), (view_hport[(0 << 0)] * 0.75), "The Kelp Fortress")
